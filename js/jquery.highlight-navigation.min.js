(function($){var methods={init:function(options){var self=this,$self=$(this);$.fn.highlightNavigation.self=$self;self.wrapper=$('<div class="highlight-navigation-container"/>');$.fn.highlightNavigation.self.after(self.wrapper).detach().appendTo(self.wrapper);$.fn.highlightNavigation.elemObjTag=$.fn.highlightNavigation.self.prop("tagName");settings=$.extend({},$.fn.highlightNavigation.defaults,options);self.selectedItem={};$(document).on("keydown.highlightNav",$.proxy(methods.keyPress,self));$(document).on("click.highlightNav",$.proxy(methods.itemClick,self));$(document).on("touchstart.highlightNav",$.proxy(methods.itemClick,self));methods.selectFirst();},selectFirst:function(){var $allItems=methods.getAllItems();if($allItems.length){$.fn.highlightNavigation.selectedItem=$allItems.eq(0).addClass("selected");settings.onSelect();settings.selectFirst();}},selectNext:function(direction){var $selectedItem={},$currentSelectedItem=methods.getSelectedItem(),$allItems=methods.getAllItems();if(direction===-1&&(($.fn.highlightNavigation.elemObjTag==="NAV"&&$currentSelectedItem.prevAll("a").length)||typeof $currentSelectedItem.prev().prop("tagName")!=="undefined")){if($.fn.highlightNavigation.elemObjTag==="NAV"){$selectedItem=$currentSelectedItem.prevAll("a:first");}else{$selectedItem=$currentSelectedItem.prev();}$selectedItem.addClass("selected");}else{if(direction===1&&(($.fn.highlightNavigation.elemObjTag==="NAV"&&$currentSelectedItem.nextAll("a").length)||typeof $currentSelectedItem.next().prop("tagName")!=="undefined")){selector="a:first";if($.fn.highlightNavigation.elemObjTag==="NAV"){$selectedItem=$currentSelectedItem.nextAll("a:first");}else{if($.fn.highlightNavigation.elemObjTag==="UL"||$.fn.highlightNavigation.elemObjTag==="OL"){$selectedItem=$currentSelectedItem.nextAll("li:first");}else{$selectedItem=$currentSelectedItem.next();}}$selectedItem.addClass("selected");}}if(!$.isEmptyObject($selectedItem)){$currentSelectedItem.removeClass("selected");$.fn.highlightNavigation.selectedItem=$selectedItem;settings.onSelect();settings.selectNext();}},keyPress:function(e){var keyCode="",direction="";e.preventDefault();if(window.event){keyCode=window.event.keyCode;}else{if(e){keyCode=e.which;}}direction=(keyCode==settings.navPrevItemKey)?-1:(keyCode==settings.navNextItemKey)?1:0;if(direction!=0){methods.selectNext(direction);}if(keyCode==settings.navActionKey){settings.actionKeyPress();}$.fn.highlightNavigation.keyCode=keyCode;settings.keyPress();},itemClick:function(e,data){var self=this,evt=(e)?e:event,itemClicked=(evt.srcElement)?evt.srcElement:evt.target,$allItems=methods.getAllItems(),$itemClicked={},$selectedItem=methods.getSelectedItem();evt.preventDefault();if($("li, tr").has($(itemClicked)).length){$itemClicked=$("li, tr").has($(itemClicked));}else{$itemClicked=$(itemClicked);}if($itemClicked.parent().prop("tagName")!=="THEAD"){$allItems.removeClass("selected");$itemClicked.addClass("selected");$.fn.highlightNavigation.selectedItem=$itemClicked;settings.itemClick();}},getAllItems:function(){switch($.fn.highlightNavigation.elemObjTag){case"TABLE":return $.fn.highlightNavigation.self.find("tbody tr");break;case"UL":return $.fn.highlightNavigation.self.find("li");break;case"OL":return $.fn.highlightNavigation.self.find("li");break;case"NAV":return $.fn.highlightNavigation.self.find("a");break;case $.fn.highlightNavigation.elemObjTag.length:return $.fn.highlightNavigation.self.children();break;default:return false;}settings.getAllItems();},getSelectedItem:function(){return $.fn.highlightNavigation.selectedItem;},selectItem:function(index){var allItems=methods.getAllItems(),$selectedItem=$(allItems.get(index));allItems.removeClass("selected");$selectedItem.addClass("selected");$.fn.highlightNavigation.selectedItem=$selectedItem;settings.onSelect();return $selectedItem;},getKeyCode:function(){return $.fn.highlightNavigation.keyCode;},destroy:function(){methods.getSelectedItem().removeClass("selected");$(document).off(".highlightNav");$.fn.highlightNavigation.self.unwrap();}};$.fn.highlightNavigation=function(method){$.fn.highlightNavigation.defaults={navPrevItemKey:38,navNextItemKey:40,navActionKey:13,selectFirst:function(){},selectNext:function(){},onSelect:function(){},keyPress:function(){},itemClick:function(){},getAllItems:function(){},selectItem:function(){},getKeyCode:function(){},actionKeyPress:function(){}};if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments);}else{$.error("Method "+method+" does not exist in highlight-navigation");}}};})(jQuery);
